[2024-07-14 23:09:42,215][   train_val.py][line:  57][    INFO] args: Namespace(config='./stitch-o_config.yaml', evaluate=False)
[2024-07-14 23:09:42,217][   train_val.py][line:  58][    INFO] config: {'criterion': [{'kwargs': {'weight': 1.0},
                'name': 'FeatureMSELoss',
                'type': 'FeatureMSELoss'}],
 'dataset': {'batch_size': 64,
             'image_reader': {'kwargs': {'image_dir': './chunks/'},
                              'type': 'npy'},
             'input_size': [176, 176],
             'normals': [0],
             'test': {'meta_file': './chunks/metadata/test_metadata.json'},
             'train': {'hflip': False,
                       'meta_file': './chunks/metadata/train_metadata.json',
                       'rebalance': False,
                       'rotate': True,
                       'vflip': False},
             'type': 'custom',
             'workers': 8},
 'evaluator': {'eval_dir': '.\\result_eval_temp',
               'key_metric': 'mean_std_auc',
               'metrics': {'auc': [{'name': 'std'},
                                   {'kwargs': {'avgpool_size': [16, 16]},
                                    'name': 'max'},
                                   {'name': 'mean'}]},
               'save_dir': 'result_eval_temp'},
 'exp_path': '.',
 'frozen_layers': ['backbone'],
 'log_path': '.\\log/',
 'net': [{'frozen': True,
          'kwargs': {'outblocks': [1, 5, 9, 21],
                     'outstrides': [2, 4, 8, 16],
                     'pretrained': True},
          'name': 'backbone',
          'type': 'models.backbones.efficientnet_b4'},
         {'kwargs': {'outplanes': [272], 'outstrides': [16]},
          'name': 'neck',
          'prev': 'backbone',
          'type': 'models.necks.MFCN'},
         {'kwargs': {'activation': 'relu',
                     'dim_feedforward': 1024,
                     'dropout': 0.1,
                     'feature_jitter': {'prob': 1.0, 'scale': 20.0},
                     'feature_size': [11, 11],
                     'hidden_dim': 256,
                     'initializer': {'method': 'xavier_uniform'},
                     'neighbor_mask': {'mask': [True, True, True],
                                       'neighbor_size': [7, 7]},
                     'nhead': 8,
                     'normalize_before': False,
                     'num_decoder_layers': 4,
                     'num_encoder_layers': 4,
                     'pos_embed_type': 'learned',
                     'save_recon': False},
          'name': 'reconstruction',
          'prev': 'neck',
          'type': 'models.reconstructions.UniAD'}],
 'port': 11111,
 'random_seed': 133,
 'save_path': '.\\stitch-o_checkpoint/',
 'saver': {'always_save': False,
           'auto_resume': False,
           'load_path': 'stitch-o_checkpoint/ckpt.pth.tar',
           'log_dir': 'log/',
           'save_dir': 'stitch-o_checkpoint/'},
 'trainer': {'clip_max_norm': 0.1,
             'lr_scheduler': {'kwargs': {'gamma': 0.1, 'step_size': 50},
                              'type': 'StepLR'},
             'max_epoch': 250,
             'optimizer': {'kwargs': {'betas': [0.9, 0.999],
                                      'lr': 0.0001,
                                      'weight_decay': 0.0001},
                           'type': 'AdamW'},
             'print_freq_step': 200,
             'tb_freq_step': 1,
             'val_freq_epoch': 10},
 'version': 'v1.0.0'}
[2024-07-14 23:09:42,462][       utils.py][line: 740][    INFO]  not exist, load from https://github.com/lukemelas/EfficientNet-PyTorch/releases/download/1.0/efficientnet-b4-6ed6700e.pth
[2024-07-14 23:09:42,531][       utils.py][line: 761][    INFO] Loaded ImageNet pretrained efficientnet-b4
[2024-07-14 23:09:42,715][   train_val.py][line:  77][    INFO] layers: ['backbone', 'neck', 'reconstruction']
[2024-07-14 23:09:42,715][   train_val.py][line:  78][    INFO] active layers: ['neck', 'reconstruction']
[2024-07-14 23:09:42,717][custom_dataset.py][line:  38][    INFO] building CustomDataset from: ./chunks/metadata/train_metadata.json
[2024-07-14 23:09:42,897][custom_dataset.py][line:  38][    INFO] building CustomDataset from: ./chunks/metadata/test_metadata.json
[2024-07-14 23:10:14,289][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 0
[2024-07-14 23:10:16,208][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 9
[2024-07-14 23:10:17,960][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 17
[2024-07-14 23:10:18,319][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 19
[2024-07-14 23:10:19,152][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 23
[2024-07-14 23:10:20,883][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 31
[2024-07-14 23:10:22,320][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 38
[2024-07-14 23:10:22,682][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 40
[2024-07-14 23:10:24,280][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 48
[2024-07-14 23:10:28,907][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 70
[2024-07-14 23:10:29,723][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 74
[2024-07-14 23:10:31,355][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 82
[2024-07-14 23:10:32,359][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 87
[2024-07-14 23:10:32,523][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 88
[2024-07-14 23:10:33,921][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 95
[2024-07-14 23:10:35,547][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 103
[2024-07-14 23:10:39,447][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 122
[2024-07-14 23:10:41,935][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 134
[2024-07-14 23:10:44,627][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 147
[2024-07-14 23:10:45,168][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 150
[2024-07-14 23:10:45,749][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 153
[2024-07-14 23:10:49,102][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 169
[2024-07-14 23:10:49,259][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 170
[2024-07-14 23:10:51,068][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 179
[2024-07-14 23:10:52,059][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 184
[2024-07-14 23:10:52,220][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 185
[2024-07-14 23:10:55,064][   train_val.py][line: 239][    INFO] Epoch: [1/250]	Iter: [200/69500]	Time 0.20 (0.41)	Data 0.00 (0.32)	Loss 35.90648 (65.50119)	LR 0.00010	
[2024-07-14 23:10:55,646][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 202
[2024-07-14 23:10:56,230][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 205
[2024-07-14 23:10:58,921][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 218
[2024-07-14 23:11:01,888][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 232
[2024-07-14 23:11:04,543][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 245
[2024-07-14 23:11:09,530][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 270
[2024-07-14 23:11:09,868][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 272
[2024-07-14 23:11:43,936][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 286
[2024-07-14 23:11:44,933][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 291
[2024-07-14 23:11:45,288][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 293
[2024-07-14 23:11:47,307][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 303
[2024-07-14 23:11:48,329][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 308
[2024-07-14 23:11:49,740][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 315
[2024-07-14 23:11:51,548][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 324
[2024-07-14 23:11:53,778][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 335
[2024-07-14 23:12:03,153][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 381
[2024-07-14 23:12:03,507][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 383
[2024-07-14 23:12:04,502][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 388
[2024-07-14 23:12:04,672][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 389
[2024-07-14 23:12:06,744][   train_val.py][line: 239][    INFO] Epoch: [2/250]	Iter: [400/69500]	Time 0.22 (0.49)	Data 0.00 (0.25)	Loss 89.04253 (48.22414)	LR 0.00010	
[2024-07-14 23:12:06,915][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 400
[2024-07-14 23:12:07,287][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 402
[2024-07-14 23:12:10,521][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 417
[2024-07-14 23:12:10,694][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 418
[2024-07-14 23:12:13,122][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 429
[2024-07-14 23:12:14,128][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 434
[2024-07-14 23:12:14,283][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 435
[2024-07-14 23:12:15,084][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 439
[2024-07-14 23:12:15,238][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 440
[2024-07-14 23:12:16,680][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 447
[2024-07-14 23:12:17,736][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 452
[2024-07-14 23:12:19,178][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 459
[2024-07-14 23:12:19,729][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 462
[2024-07-14 23:12:19,888][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 463
[2024-07-14 23:12:21,334][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 470
[2024-07-14 23:12:22,810][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 477
[2024-07-14 23:12:24,217][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 484
[2024-07-14 23:12:24,572][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 486
[2024-07-14 23:12:24,731][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 487
[2024-07-14 23:12:25,549][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 491
[2024-07-14 23:12:25,715][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 492
[2024-07-14 23:12:26,324][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 495
[2024-07-14 23:12:26,492][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 496
[2024-07-14 23:12:27,089][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 499
[2024-07-14 23:12:29,772][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 512
[2024-07-14 23:12:30,995][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 518
[2024-07-14 23:12:32,891][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 527
[2024-07-14 23:12:33,059][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 528
[2024-07-14 23:12:34,739][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 536
[2024-07-14 23:12:35,495][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 540
[2024-07-14 23:12:36,631][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 546
[2024-07-14 23:12:37,563][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 551
[2024-07-14 23:13:08,857][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 558
[2024-07-14 23:13:11,396][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 570
[2024-07-14 23:13:12,245][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 574
[2024-07-14 23:13:14,373][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 584
[2024-07-14 23:13:16,251][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 593
[2024-07-14 23:13:16,617][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 595
[2024-07-14 23:13:17,205][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 598
[2024-07-14 23:13:17,370][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 599
[2024-07-14 23:13:17,732][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 601
[2024-07-14 23:13:19,427][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 609
[2024-07-14 23:13:20,425][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 614
[2024-07-14 23:13:22,040][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 622
[2024-07-14 23:13:22,416][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 624
[2024-07-14 23:13:24,393][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 634
[2024-07-14 23:13:26,411][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 644
[2024-07-14 23:13:26,779][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 646
[2024-07-14 23:13:29,841][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 661
[2024-07-14 23:13:30,617][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 665
[2024-07-14 23:13:31,606][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 670
[2024-07-14 23:13:33,017][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 677
[2024-07-14 23:13:34,430][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 684
[2024-07-14 23:13:34,598][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 685
[2024-07-14 23:13:35,386][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 689
[2024-07-14 23:13:36,365][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 694
[2024-07-14 23:13:37,544][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 700
[2024-07-14 23:13:40,393][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 714
[2024-07-14 23:13:40,953][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 717
[2024-07-14 23:13:41,103][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 718
[2024-07-14 23:13:42,133][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 723
[2024-07-14 23:13:43,112][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 728
[2024-07-14 23:13:43,694][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 731
[2024-07-14 23:13:44,065][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 733
[2024-07-14 23:13:44,233][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 734
[2024-07-14 23:13:45,401][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 740
[2024-07-14 23:13:45,958][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 743
[2024-07-14 23:13:48,194][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 754
[2024-07-14 23:13:50,664][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 766
[2024-07-14 23:13:53,529][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 780
[2024-07-14 23:13:55,592][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 790
[2024-07-14 23:13:57,476][   train_val.py][line: 239][    INFO] Epoch: [3/250]	Iter: [800/69500]	Time 0.20 (0.24)	Data 0.00 (0.03)	Loss 12.49536 (39.36872)	LR 0.00010	
[2024-07-14 23:13:58,262][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 803
[2024-07-14 23:14:01,420][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 818
[2024-07-14 23:14:01,567][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 819
[2024-07-14 23:14:01,735][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 820
