[2024-07-15 19:40:25,348][   train_val.py][line:  57][    INFO] args: Namespace(config='./stitch-o_config.yaml', evaluate=False)
[2024-07-15 19:40:25,349][   train_val.py][line:  58][    INFO] config: {'criterion': [{'kwargs': {'weight': 1.0},
                'name': 'FeatureMSELoss',
                'type': 'FeatureMSELoss'}],
 'dataset': {'batch_size': 64,
             'image_reader': {'kwargs': {'image_dir': './chunks/'},
                              'type': 'npy'},
             'input_size': [176, 176],
             'normals': [0],
             'test': {'meta_file': './chunks/metadata/test_metadata.json'},
             'train': {'hflip': False,
                       'meta_file': './chunks/metadata/train_metadata.json',
                       'rebalance': False,
                       'rotate': True,
                       'vflip': False},
             'type': 'custom',
             'workers': 8},
 'evaluator': {'eval_dir': '.\\result_eval_temp',
               'key_metric': 'mean_std_auc',
               'metrics': {'auc': [{'name': 'std'},
                                   {'kwargs': {'avgpool_size': [16, 16]},
                                    'name': 'max'},
                                   {'name': 'mean'}]},
               'save_dir': 'result_eval_temp'},
 'exp_path': '.',
 'frozen_layers': ['backbone'],
 'log_path': '.\\log/',
 'net': [{'frozen': True,
          'kwargs': {'outblocks': [1, 5, 9, 21],
                     'outstrides': [2, 4, 8, 16],
                     'pretrained': True},
          'name': 'backbone',
          'type': 'models.backbones.efficientnet_b4'},
         {'kwargs': {'outplanes': [272], 'outstrides': [16]},
          'name': 'neck',
          'prev': 'backbone',
          'type': 'models.necks.MFCN'},
         {'kwargs': {'activation': 'relu',
                     'dim_feedforward': 1024,
                     'dropout': 0.1,
                     'feature_jitter': {'prob': 1.0, 'scale': 20.0},
                     'feature_size': [11, 11],
                     'hidden_dim': 256,
                     'initializer': {'method': 'xavier_uniform'},
                     'neighbor_mask': {'mask': [True, True, True],
                                       'neighbor_size': [7, 7]},
                     'nhead': 8,
                     'normalize_before': False,
                     'num_decoder_layers': 4,
                     'num_encoder_layers': 4,
                     'pos_embed_type': 'learned',
                     'save_recon': False},
          'name': 'reconstruction',
          'prev': 'neck',
          'type': 'models.reconstructions.UniAD'}],
 'port': 11111,
 'random_seed': 133,
 'save_path': '.\\stitch-o_checkpoint/',
 'saver': {'always_save': False,
           'auto_resume': False,
           'load_path': 'stitch-o_checkpoint/ckpt.pth.tar',
           'log_dir': 'log/',
           'save_dir': 'stitch-o_checkpoint/'},
 'trainer': {'clip_max_norm': 0.1,
             'lr_scheduler': {'kwargs': {'gamma': 0.1, 'step_size': 50},
                              'type': 'StepLR'},
             'max_epoch': 250,
             'optimizer': {'kwargs': {'betas': [0.9, 0.999],
                                      'lr': 0.0001,
                                      'weight_decay': 0.0001},
                           'type': 'AdamW'},
             'print_freq_step': 200,
             'tb_freq_step': 1,
             'val_freq_epoch': 10},
 'version': 'v1.0.0'}
[2024-07-15 19:40:25,621][       utils.py][line: 740][    INFO]  not exist, load from https://github.com/lukemelas/EfficientNet-PyTorch/releases/download/1.0/efficientnet-b4-6ed6700e.pth
[2024-07-15 19:40:25,695][       utils.py][line: 761][    INFO] Loaded ImageNet pretrained efficientnet-b4
[2024-07-15 19:40:25,896][   train_val.py][line:  77][    INFO] layers: ['backbone', 'neck', 'reconstruction']
[2024-07-15 19:40:25,896][   train_val.py][line:  78][    INFO] active layers: ['reconstruction', 'neck']
[2024-07-15 19:40:25,900][custom_dataset.py][line:  38][    INFO] building CustomDataset from: ./chunks/metadata/train_metadata.json
[2024-07-15 19:40:26,077][custom_dataset.py][line:  38][    INFO] building CustomDataset from: ./chunks/metadata/test_metadata.json
[2024-07-15 19:40:58,762][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 0
[2024-07-15 19:40:58,937][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1
[2024-07-15 19:40:59,107][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2
[2024-07-15 19:40:59,268][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 3
[2024-07-15 19:40:59,425][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 4
[2024-07-15 19:40:59,588][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 5
[2024-07-15 19:40:59,754][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 6
[2024-07-15 19:40:59,907][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 7
[2024-07-15 19:41:00,071][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 8
[2024-07-15 19:41:00,237][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 9
[2024-07-15 19:41:00,401][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 10
[2024-07-15 19:41:00,569][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 11
[2024-07-15 19:41:00,736][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 12
[2024-07-15 19:41:00,902][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 13
[2024-07-15 19:41:01,067][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 14
[2024-07-15 19:41:01,240][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 15
[2024-07-15 19:41:01,411][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 16
[2024-07-15 19:41:01,596][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 17
[2024-07-15 19:41:01,776][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 18
[2024-07-15 19:41:01,953][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 19
[2024-07-15 19:41:02,133][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 20
[2024-07-15 19:41:02,302][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 21
[2024-07-15 19:41:02,468][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 22
[2024-07-15 19:41:02,618][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 23
[2024-07-15 19:41:02,777][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 24
[2024-07-15 19:41:02,929][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 25
[2024-07-15 19:41:03,092][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 26
[2024-07-15 19:41:03,245][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 27
[2024-07-15 19:41:03,407][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 28
[2024-07-15 19:41:03,571][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 29
[2024-07-15 19:41:03,736][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 30
[2024-07-15 19:41:03,885][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 31
[2024-07-15 19:41:04,045][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 32
[2024-07-15 19:41:04,195][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 33
[2024-07-15 19:41:04,359][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 34
[2024-07-15 19:41:04,510][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 35
[2024-07-15 19:41:04,672][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 36
[2024-07-15 19:41:04,822][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 37
[2024-07-15 19:41:04,983][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 38
[2024-07-15 19:41:05,136][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 39
[2024-07-15 19:41:05,302][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 40
[2024-07-15 19:41:05,466][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 41
[2024-07-15 19:41:05,621][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 42
[2024-07-15 19:41:05,784][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 43
[2024-07-15 19:41:05,950][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 44
[2024-07-15 19:41:06,106][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 45
[2024-07-15 19:41:06,271][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 46
[2024-07-15 19:41:06,437][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 47
[2024-07-15 19:41:06,600][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 48
[2024-07-15 19:41:06,752][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 49
[2024-07-15 19:41:06,913][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 50
[2024-07-15 19:41:07,059][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 51
[2024-07-15 19:41:07,222][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 52
[2024-07-15 19:41:07,371][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 53
[2024-07-15 19:41:07,531][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 54
[2024-07-15 19:41:07,682][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 55
[2024-07-15 19:41:07,844][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 56
[2024-07-15 19:41:08,001][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 57
[2024-07-15 19:41:08,160][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 58
[2024-07-15 19:41:08,311][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 59
[2024-07-15 19:41:08,473][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 60
[2024-07-15 19:41:08,638][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 61
[2024-07-15 19:41:08,788][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 62
[2024-07-15 19:41:08,948][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 63
[2024-07-15 19:41:09,098][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 64
[2024-07-15 19:41:09,262][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 65
[2024-07-15 19:41:09,414][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 66
[2024-07-15 19:41:09,580][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 67
[2024-07-15 19:41:09,731][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 68
[2024-07-15 19:41:09,900][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 69
[2024-07-15 19:41:10,063][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 70
[2024-07-15 19:41:10,214][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 71
[2024-07-15 19:41:10,376][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 72
[2024-07-15 19:41:10,543][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 73
[2024-07-15 19:41:10,707][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 74
[2024-07-15 19:41:10,857][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 75
[2024-07-15 19:41:11,027][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 76
[2024-07-15 19:41:11,203][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 77
[2024-07-15 19:41:11,380][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 78
[2024-07-15 19:41:11,550][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 79
[2024-07-15 19:41:11,726][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 80
[2024-07-15 19:41:11,894][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 81
[2024-07-15 19:41:12,066][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 82
[2024-07-15 19:41:12,227][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 83
[2024-07-15 19:41:12,395][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 84
[2024-07-15 19:41:12,556][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 85
[2024-07-15 19:41:12,709][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 86
[2024-07-15 19:41:12,869][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 87
[2024-07-15 19:41:13,018][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 88
[2024-07-15 19:41:13,175][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 89
[2024-07-15 19:41:13,321][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 90
[2024-07-15 19:41:13,484][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 91
[2024-07-15 19:41:13,652][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 92
[2024-07-15 19:41:13,814][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 93
[2024-07-15 19:41:13,978][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 94
[2024-07-15 19:41:14,138][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 95
[2024-07-15 19:41:14,293][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 96
[2024-07-15 19:41:14,453][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 97
[2024-07-15 19:41:14,607][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 98
[2024-07-15 19:41:14,764][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 99
[2024-07-15 19:41:14,916][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 100
[2024-07-15 19:41:15,080][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 101
[2024-07-15 19:41:15,233][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 102
[2024-07-15 19:41:15,392][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 103
[2024-07-15 19:41:15,543][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 104
[2024-07-15 19:41:15,705][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 105
[2024-07-15 19:41:15,871][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 106
[2024-07-15 19:41:16,021][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 107
[2024-07-15 19:41:16,184][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 108
[2024-07-15 19:41:16,346][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 109
[2024-07-15 19:41:16,497][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 110
[2024-07-15 19:41:16,653][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 111
[2024-07-15 19:41:16,803][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 112
[2024-07-15 19:41:16,964][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 113
[2024-07-15 19:41:17,106][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 114
[2024-07-15 19:41:17,257][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 115
