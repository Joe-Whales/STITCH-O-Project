[2024-07-15 21:33:05,192][   train_val.py][line:  57][    INFO] args: Namespace(config='./stitch-o_config.yaml', evaluate=False)
[2024-07-15 21:33:05,194][   train_val.py][line:  58][    INFO] config: {'criterion': [{'kwargs': {'weight': 1.0},
                'name': 'FeatureMSELoss',
                'type': 'FeatureMSELoss'}],
 'dataset': {'batch_size': 64,
             'image_reader': {'kwargs': {'image_dir': './chunks/'},
                              'type': 'npy'},
             'input_size': [176, 176],
             'normals': [0],
             'test': {'meta_file': './chunks/metadata/test_metadata.json'},
             'train': {'hflip': False,
                       'meta_file': './chunks/metadata/train_metadata.json',
                       'rebalance': False,
                       'rotate': True,
                       'vflip': False},
             'type': 'custom',
             'workers': 8},
 'evaluator': {'eval_dir': '.\\result_eval_temp',
               'key_metric': 'mean_std_auc',
               'metrics': {'auc': [{'name': 'std'},
                                   {'kwargs': {'avgpool_size': [16, 16]},
                                    'name': 'max'},
                                   {'name': 'mean'}]},
               'save_dir': 'result_eval_temp'},
 'exp_path': '.',
 'frozen_layers': ['backbone'],
 'log_path': '.\\log/',
 'net': [{'frozen': True,
          'kwargs': {'outblocks': [1, 5, 9, 21],
                     'outstrides': [2, 4, 8, 16],
                     'pretrained': True},
          'name': 'backbone',
          'type': 'models.backbones.efficientnet_b4'},
         {'kwargs': {'outplanes': [272], 'outstrides': [16]},
          'name': 'neck',
          'prev': 'backbone',
          'type': 'models.necks.MFCN'},
         {'kwargs': {'activation': 'relu',
                     'dim_feedforward': 1024,
                     'dropout': 0.1,
                     'feature_jitter': {'prob': 1.0, 'scale': 20.0},
                     'feature_size': [11, 11],
                     'hidden_dim': 256,
                     'initializer': {'method': 'xavier_uniform'},
                     'neighbor_mask': {'mask': [True, True, True],
                                       'neighbor_size': [7, 7]},
                     'nhead': 8,
                     'normalize_before': False,
                     'num_decoder_layers': 4,
                     'num_encoder_layers': 4,
                     'pos_embed_type': 'learned',
                     'save_recon': False},
          'name': 'reconstruction',
          'prev': 'neck',
          'type': 'models.reconstructions.UniAD'}],
 'port': 11111,
 'random_seed': 133,
 'save_path': '.\\stitch-o_checkpoint/',
 'saver': {'always_save': False,
           'auto_resume': False,
           'load_path': 'stitch-o_checkpoint/ckpt.pth.tar',
           'log_dir': 'log/',
           'save_dir': 'stitch-o_checkpoint/'},
 'trainer': {'clip_max_norm': 0.1,
             'lr_scheduler': {'kwargs': {'gamma': 0.1, 'step_size': 50},
                              'type': 'StepLR'},
             'max_epoch': 250,
             'optimizer': {'kwargs': {'betas': [0.9, 0.999],
                                      'lr': 0.0001,
                                      'weight_decay': 0.0001},
                           'type': 'AdamW'},
             'print_freq_step': 200,
             'tb_freq_step': 1,
             'val_freq_epoch': 10},
 'version': 'v1.0.0'}
[2024-07-15 21:33:05,453][       utils.py][line: 740][    INFO]  not exist, load from https://github.com/lukemelas/EfficientNet-PyTorch/releases/download/1.0/efficientnet-b4-6ed6700e.pth
[2024-07-15 21:33:05,521][       utils.py][line: 761][    INFO] Loaded ImageNet pretrained efficientnet-b4
[2024-07-15 21:33:05,714][   train_val.py][line:  77][    INFO] layers: ['backbone', 'neck', 'reconstruction']
[2024-07-15 21:33:05,714][   train_val.py][line:  78][    INFO] active layers: ['neck', 'reconstruction']
[2024-07-15 21:33:09,747][custom_dataset.py][line:  38][    INFO] building CustomDataset from: ./chunks/metadata/train_metadata.json
[2024-07-15 21:33:09,831][custom_dataset.py][line:  38][    INFO] building CustomDataset from: ./chunks/metadata/test_metadata.json
[2024-07-15 21:33:56,050][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 74
[2024-07-15 21:34:11,866][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 150
[2024-07-15 21:34:22,110][   train_val.py][line: 235][    INFO] Epoch: [1/250]	Iter: [200/69500]	Time 0.21 (0.36)	Data 0.00 (0.14)	Loss 14.19967 (15.08373)	LR 0.00010	
[2024-07-15 21:34:33,628][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 254
[2024-07-15 21:34:33,777][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 255
[2024-07-15 21:35:33,516][   train_val.py][line: 235][    INFO] Epoch: [2/250]	Iter: [400/69500]	Time 0.20 (0.44)	Data 0.00 (0.23)	Loss 17.13831 (13.87409)	LR 0.00010	
[2024-07-15 21:35:37,188][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 417
[2024-07-15 21:35:43,586][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 448
[2024-07-15 21:36:43,863][   train_val.py][line: 235][    INFO] Epoch: [3/250]	Iter: [600/69500]	Time 0.21 (0.84)	Data 0.00 (0.63)	Loss 12.89463 (13.44973)	LR 0.00010	
[2024-07-15 21:36:44,227][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 601
[2024-07-15 21:36:46,859][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 614
[2024-07-15 21:36:48,833][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 624
[2024-07-15 21:37:11,177][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 733
[2024-07-15 21:37:24,569][   train_val.py][line: 235][    INFO] Epoch: [3/250]	Iter: [800/69500]	Time 0.21 (0.21)	Data 0.00 (0.00)	Loss 19.12567 (13.22499)	LR 0.00010	
[2024-07-15 21:38:25,878][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 959
[2024-07-15 21:38:31,804][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 988
[2024-07-15 21:38:34,030][   train_val.py][line: 235][    INFO] Epoch: [4/250]	Iter: [1000/69500]	Time 0.21 (0.38)	Data 0.00 (0.17)	Loss 12.03337 (12.88414)	LR 0.00010	
[2024-07-15 21:38:41,252][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1035
[2024-07-15 21:39:36,995][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1167
[2024-07-15 21:39:43,597][   train_val.py][line: 235][    INFO] Epoch: [5/250]	Iter: [1200/69500]	Time 0.21 (0.53)	Data 0.00 (0.32)	Loss 13.21427 (12.75777)	LR 0.00010	
[2024-07-15 21:39:51,356][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1237
[2024-07-15 21:39:54,392][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1252
[2024-07-15 21:40:06,298][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1310
[2024-07-15 21:40:09,136][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1324
[2024-07-15 21:40:09,503][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1326
[2024-07-15 21:40:53,222][   train_val.py][line: 235][    INFO] Epoch: [6/250]	Iter: [1400/69500]	Time 0.21 (3.00)	Data 0.00 (2.77)	Loss 11.83281 (12.48695)	LR 0.00010	
[2024-07-15 21:41:15,981][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1511
[2024-07-15 21:41:16,760][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1515
[2024-07-15 21:41:33,832][   train_val.py][line: 235][    INFO] Epoch: [6/250]	Iter: [1600/69500]	Time 0.20 (0.21)	Data 0.00 (0.00)	Loss 11.32804 (12.32502)	LR 0.00010	
[2024-07-15 21:42:26,103][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1715
[2024-07-15 21:42:43,205][   train_val.py][line: 235][    INFO] Epoch: [7/250]	Iter: [1800/69500]	Time 0.21 (0.42)	Data 0.00 (0.21)	Loss 11.34941 (12.21628)	LR 0.00010	
[2024-07-15 21:42:45,018][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1808
[2024-07-15 21:42:47,639][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1821
[2024-07-15 21:42:54,499][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1855
[2024-07-15 21:43:02,427][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1895
[2024-07-15 21:43:02,781][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1897
[2024-07-15 21:43:05,338][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1910
[2024-07-15 21:43:50,879][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 1993
[2024-07-15 21:43:52,109][   train_val.py][line: 235][    INFO] Epoch: [8/250]	Iter: [2000/69500]	Time 0.20 (0.73)	Data 0.00 (0.51)	Loss 12.36174 (12.27493)	LR 0.00010	
[2024-07-15 21:43:53,086][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2004
[2024-07-15 21:44:04,523][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2060
[2024-07-15 21:44:05,891][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2067
[2024-07-15 21:44:08,507][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2080
[2024-07-15 21:44:11,762][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2096
[2024-07-15 21:44:12,135][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2098
[2024-07-15 21:44:13,095][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2103
[2024-07-15 21:44:20,560][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2140
[2024-07-15 21:44:32,480][   train_val.py][line: 235][    INFO] Epoch: [8/250]	Iter: [2200/69500]	Time 0.20 (0.21)	Data 0.00 (0.01)	Loss 10.99108 (11.91610)	LR 0.00010	
[2024-07-15 21:44:33,666][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2205
[2024-07-15 21:45:06,843][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2228
[2024-07-15 21:45:07,764][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2233
[2024-07-15 21:45:10,527][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2247
[2024-07-15 21:45:10,880][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2249
[2024-07-15 21:45:15,779][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2273
[2024-07-15 21:45:32,468][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2355
[2024-07-15 21:45:41,457][   train_val.py][line: 235][    INFO] Epoch: [9/250]	Iter: [2400/69500]	Time 0.20 (0.37)	Data 0.00 (0.16)	Loss 11.06893 (11.81813)	LR 0.00010	
[2024-07-15 21:45:43,257][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2408
[2024-07-15 21:45:44,446][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2414
[2024-07-15 21:45:45,397][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2419
[2024-07-15 21:45:49,666][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2440
[2024-07-15 21:45:54,701][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2465
[2024-07-15 21:45:58,098][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2482
[2024-07-15 21:46:44,383][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2568
[2024-07-15 21:46:46,208][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2577
[2024-07-15 21:46:50,850][   train_val.py][line: 235][    INFO] Epoch: [10/250]	Iter: [2600/69500]	Time 0.20 (0.50)	Data 0.00 (0.29)	Loss 11.58978 (11.68151)	LR 0.00010	
[2024-07-15 21:46:55,110][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2620
[2024-07-15 21:46:56,705][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2628
[2024-07-15 21:46:57,087][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2630
[2024-07-15 21:46:59,088][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2640
[2024-07-15 21:46:59,451][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2642
[2024-07-15 21:47:09,225][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2690
[2024-07-15 21:47:17,865][   train_val.py][line: 203][ WARNING] NaN or Inf detected in model output at step 2733
[2024-07-15 21:48:08,271][   train_val.py][line: 298][    INFO] Gathering final results ...
[2024-07-15 21:48:08,272][   train_val.py][line: 300][    INFO]  * Loss 13.50328	total_num=2039.0
[2024-07-15 21:48:28,220][ eval_helper.py][line: 224][    INFO] 
|  clsname  |   mean   |   std    |   max    |
|:---------:|:--------:|:--------:|:--------:|
| UOG_2057  | 0.517036 | 0.756745 | 0.723334 |
| UOG_1676  | 0.976052 | 0.783543 | 0.939871 |
| UOG_1996  | 0.69489  | 0.676891 | 0.631272 |
|   mean    | 0.729326 | 0.73906  | 0.764826 |
[2024-07-15 21:48:28,238][   train_val.py][line: 135][    INFO] best_metric = 0.7390596581396215
